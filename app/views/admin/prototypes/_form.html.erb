<div class="text">
  <% f.field_container :name do %>
    <%= f.label :name, t(:name) %>
    <%= f.text_field :name %>
    <%= f.error_message_on :name %>
  <% end %>
</div>
<h3><%= t :properties %></h3>
<ul>
  <% Property.sorted.each do |property| %>
  <% selected = if @prototype.new_record? (params[:property] and params[:property][:id] and params[:property][:id].include?(property.id.to_s)) else @prototype.properties.include?(property) end %>
    <li>
      <label><%= check_box_tag "property[id][]", "#{property.id}", selected %><%= property.name %></label>
    </li>
  <% end %>
</ul>
